# Smesh with VM's Use Case  

## This use case shows how to run an microservice application in a mixed container and virtual machine environment

## To create Application

1 Install Operators and Traffic Generation Image from Readme - [servicemesh-demos](https://github.com/sa-ne/servicemesh-demos)

## Create ArgoCD Application via ACM

1 ```kustomize build ./use-cases/smesh-with-vms/create_via_acm/ --enable-alpha-plugins```

## Create ArgoCD Application directly

1 Create ArgoCD Application for Infrastructure required by use case
  ```oc apply -k ./use-cases/smesh-with-vms/infra/ --enable-alpha-plugins```

2 Create ArgoCD Application for Bookinfo Application Components
  ```oc apply -k ./use-cases/smesh-with-vms/app --enable-alpha-plugins```

3 Create ArgoCD Application for Traffic Generation
  ```oc apply -k ./use-cases/smesh-with-vms/traffic-generator/ --enable-alpha-plugins```

## Known Problems

- The servicemeshmesh sync does not always work correctly or does not inject istio-proxy into pods.If this happens delete the servicemeshmemberroll in istio-system and allow gitops re-create it.
